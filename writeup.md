---
title: "Stored and reflected XSS - TODO"
date: 2023-04-24T14:33:43Z
draft: false
toc: false
images:
tags:
  - stored
  - reflected
  - XSS
  - injection
---
<!-- These are required fields for the disclosure process -->
**Affected Product:** Evasys 

**Affected Versions:**  evasys v8.2 Build 2275 - 2285 and evasys v9.0 Build 2400 (both according to vendor)
 

**Fixed Version:** v8.2 Build 2286 and v9.0 Build 2401 

**CVE-Number:** TODO 

**Severity:** 7,6 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L)
<!-- Add your names. -->
*Discovered by Dipl-Ing. Mario Rubak, BSc MSc and Regina Kohl, BSc*

<!-- Brief introduction. -->
The web application has numerous identified persistent and reflected XSS vulnerabilities. 

## Proof of Concept
<!-- In Depth discussion of the vulnerability. Whats it's impact, show enough proof but not too much. DO NOT INCLUDE EXPLOIT PAYLOADS! -->
For example, in the user profile, JavaScript or HTML code can be injected into the GUI-fields "Titel," "Vorname," and "Nachname," which will be executed by the browser in various places within the web application.

![Injecting HTML and Javascript code via the user profile](../images/XSS_1)

The HTML code, but not the JavaScript code, is executed in the following view:
```
Payload:
<a href=”https://it-tuv.com”>TUV Link</a>

Point of Execution:
https://example.com/evasys/public/online/index/preview?surveyid=1981652331&frmid=2142&nLangID=0&sLang=de_com&ONLINEID=
```

![Injecting HTML links via the user profile](../images/XSS_2)
The JavaScript code, however, is executed in at least two places: on the usage statistics page and in the system status page. However, this list is not exhaustive. The following example demonstrates the execution of JavaScript code using the usage statistics page.
```
Payload:
<form><button formaction=javascript&colon;confirm("TUV_XSS")>TÜV XSS

Point of Execution:
https://example.com/evasys/folders.php?mode=nutzung&TOKEN=<censored>&sNewMenuitemID=UsageStatistics
```

![XSS code triggers when the page is displayed](../images/XSS_3)

Additionaly a user with the role "Trainer" can trigger a reflected XSS by using the following link:
```
https://example.com/evasys/public/online/index/preview?frmid=2130&nLangID=222222%22%3E%3Cimage%20src/onerror=confirm('tuv')%3E
```

![Reflected cross site scripting](../images/XSS_5)

Afterwards, a link containing an online ID, which is generated by the server, can be found in the server response.
```
https://example.com/evasys/public/online/index/input?ONLINEID=1125097277626469055301441541485<censored>
```
After generating the link with the online ID, the server response will contain a link that no longer includes the payload. This link can then be sent to any (unauthenticated) person. When the link is accessed, it will display the survey and execute the payload injected by the user with the Trainer role.


![Persistent XSS via online questionnaire](../images/XSS_6)

## Vendor contact timeline 
<!-- Fill in your contact timeline!-->
| Date       | Action                                                                                                                                                                             |
|------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 2022/07/26    | Discovery of the vulnerability    |
| 2023/08/05    | Bulk disclosure of multiple vulnerabilities using the vendors support mail    |
| 2023/08/08    | Vendors respond that they acknowledge the findings and start to work on a fix    |
| 2023/08/10    | Evasys shares detailed plan for the fix with the researchers and asks for a few months of time before disclosing the vulnerability    |
| 2023/08/23    | Vendor responds that the vulnerabilities will be fixed in version 8.2 and 9.0 in 2023/09/06  |
| 2023/01/02    | First attempt to request CVEs at MITRE  |
| 2023/03/23    | Request was closed by MITRE without stating a reason  |
| 2023/04/24    | Second attempt to request CVEs at MITRE   |
| 2023/03/02    | MITRE assigns  TODO |
| 2023/TODO/TODO    | TODO  |
| 2023/TODO/TODO    | TODO  |
| 2023/TODO/TODO    | TODO  |

